<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Mera Monitor - Application Usage Report</title>
    <style>
        /* A little bit of external styling for fonts and icons, the rest is inline */
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600&display=swap');
        body {
            font-family: 'Inter', sans-serif;
            background-color: #f8f9fa;
            margin: 0;
            padding: 2rem;
            color: #333;
        }
    </style>
</head>
<body style="background-color: #f8f9fa; font-family: 'Inter', sans-serif;">

    <div id="app-container" style="max-width: 1200px; margin: auto; background: #fff; border-radius: 8px; box-shadow: 0 4px 6px rgba(0,0,0,0.05); border: 1px solid #e9ecef; padding: 24px;">

        <!-- Header Controls -->
        <div id="controls" style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 24px; flex-wrap: wrap; gap: 16px;">
            <div style="position: relative;">
                <input type="search" id="app-search" placeholder="Search Application or Website" style="padding: 10px 10px 10px 35px; border-radius: 6px; border: 1px solid #ced4da; font-size: 14px; min-width: 250px;">
                 <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" style="position: absolute; left: 12px; top: 12px; color: #6c757d;" viewBox="0 0 16 16">
                    <path d="M11.742 10.344a6.5 6.5 0 1 0-1.397 1.398h-.001c.03.04.062.078.098.115l3.85 3.85a1 1 0 0 0 1.415-1.414l-3.85-3.85a1.007 1.007 0 0 0-.115-.1zM12 6.5a5.5 5.5 0 1 1-11 0 5.5 5.5 0 0 1 11 0z"/>
                </svg>
            </div>
            <div style="display: flex; align-items: center; gap: 10px;">
                <input type="date" id="start-date" style="padding: 10px; border-radius: 6px; border: 1px solid #ced4da; font-size: 14px;">
                <span style="color: #6c757d;">â†’</span>
                <input type="date" id="end-date" style="padding: 10px; border-radius: 6px; border: 1px solid #ced4da; font-size: 14px;">
                <button id="search-btn" style="padding: 10px 20px; border: none; background-color: #6D4BDB; color: white; border-radius: 6px; cursor: pointer; font-size: 14px; font-weight: 500;">Search</button>
            </div>
        </div>

        <!-- Report Table -->
        <div id="report-table">
            <table style="width: 100%; border-collapse: collapse; font-size: 14px;">
                <thead>
                    <tr style="border-bottom: 1px solid #dee2e6;">
                        <th style="text-align: left; padding: 12px; color: #6c757d; font-weight: 500; width: 30%;">TEAM MEMBER</th>
                        <th style="text-align: left; padding: 12px; color: #6c757d; font-weight: 500; width: 30%;">TOTAL TIME SPENT</th>
                        <th style="text-align: left; padding: 12px; color: #6c757d; font-weight: 500; width: 20%;">CATEGORY</th>
                        <th style="text-align: center; padding: 12px; color: #6c757d; font-weight: 500; width: 20%;">ACTION</th>
                    </tr>
                </thead>
                <tbody id="report-body">
                    <!-- Dynamic rows will be inserted here -->
                     <tr><td colspan="4" style="text-align:center; padding: 40px; color: #6c757d;">Please search for an application to see the report.</td></tr>
                </tbody>
            </table>
        </div>
    </div>

    <script>
        // --- DUMMY DATA ---
        // In a real application, this data would come from a server.
        const usageData = [
            { user: 'Priya Sharma', app: 'https://app.clickup.com', startTime: '2025-10-14T09:05:00', endTime: '2025-10-14T11:30:00', category: 'Productivity' },
            { user: 'Rohan Joshi', app: 'https://app.clickup.com', startTime: '2025-10-14T10:15:00', endTime: '2025-10-14T12:00:00', category: 'Productivity' },
            { user: 'Priya Sharma', app: 'https://app.clickup.com', startTime: '2025-10-14T14:00:00', endTime: '2025-10-14T15:45:10', category: 'Productivity' },
            { user: 'Ananya Rao', app: 'Adobe Photoshop', startTime: '2025-10-14T11:00:00', endTime: '2025-10-14T13:20:30', category: 'Design' },
            { user: 'Priya Sharma', app: 'https://app.clickup.com', startTime: '2025-10-15T09:30:00', endTime: '2025-10-15T12:10:25', category: 'Productivity' },
            { user: 'Rohan Joshi', app: 'VS Code', startTime: '2025-10-15T09:00:00', endTime: '2025-10-15T17:00:00', category: 'Development' },
            { user: 'Ananya Rao', app: 'https://app.clickup.com', startTime: '2025-10-15T14:00:00', endTime: '2025-10-15T16:30:00', category: 'Productivity' },
            { user: 'Priya Sharma', app: 'Slack', startTime: '2025-10-16T10:00:00', endTime: '2025-10-16T10:15:00', category: 'Communication' },
            { user: 'Rohan Joshi', app: 'https://app.clickup.com', startTime: '2025-10-16T11:00:00', endTime: '2025-10-16T11:45:55', category: 'Productivity' },
        ];

        // --- UTILITY FUNCTIONS ---
        function formatDuration(seconds) {
            if (isNaN(seconds) || seconds < 0) return '0s';
            const h = Math.floor(seconds / 3600);
            const m = Math.floor((seconds % 3600) / 60);
            const s = Math.floor(seconds % 60);
            return `${h}hrs ${m}min ${s}sec`;
        }
        
        // --- CORE LOGIC ---
        document.getElementById('search-btn').addEventListener('click', function() {
            const appName = document.getElementById('app-search').value.toLowerCase();
            const startDate = new Date(document.getElementById('start-date').value);
            const endDate = new Date(document.getElementById('end-date').value);
            endDate.setHours(23, 59, 59, 999); // Include the whole end day

            if (!appName) {
                alert('Please enter an application name.');
                return;
            }
             if (isNaN(startDate.getTime()) || isNaN(endDate.getTime())) {
                alert('Please select a valid date range.');
                return;
            }

            // 1. Filter data based on criteria
            const filteredData = usageData.filter(item => {
                const itemDate = new Date(item.startTime);
                const appMatch = item.app.toLowerCase().includes(appName);
                const dateMatch = itemDate >= startDate && itemDate <= endDate;
                return appMatch && dateMatch;
            });

            // 2. Process and aggregate data
            const userReports = {};
            filteredData.forEach(item => {
                const duration = (new Date(item.endTime) - new Date(item.startTime)) / 1000;
                const dateKey = new Date(item.startTime).toISOString().split('T')[0];

                if (!userReports[item.user]) {
                    userReports[item.user] = {
                        totalDuration: 0,
                        category: item.category,
                        dailyUsage: {}
                    };
                }

                userReports[item.user].totalDuration += duration;
                
                if (!userReports[item.user].dailyUsage[dateKey]) {
                    userReports[item.user].dailyUsage[dateKey] = 0; // Initialize total for the day
                }
                userReports[item.user].dailyUsage[dateKey] += duration; // Add session duration to the daily total
            });

            // 3. Render the report
            renderReport(userReports);
        });

        function renderReport(userReports) {
            const reportBody = document.getElementById('report-body');
            reportBody.innerHTML = '';

            if (Object.keys(userReports).length === 0) {
                reportBody.innerHTML = '<tr><td colspan="4" style="text-align:center; padding: 40px; color: #6c757d;">No usage data found for the selected criteria.</td></tr>';
                return;
            }

            // Sort users alphabetically
            const sortedUsers = Object.keys(userReports).sort();

            sortedUsers.forEach(user => {
                const report = userReports[user];
                
                // Main Row
                const mainRow = document.createElement('tr');
                mainRow.style.borderBottom = '1px solid #e9ecef';
                mainRow.innerHTML = `
                    <td style="padding: 16px; font-weight: 500;">${user}</td>
                    <td style="padding: 16px;">${formatDuration(report.totalDuration)}</td>
                    <td style="padding: 16px; ">${report.category}</td>
                    <td style="padding: 16px; text-align: center;">
                        <button class="view-btn" style="background-color: #6D4BDB; color: white; border: none; padding: 8px 24px; border-radius: 6px; cursor: pointer; font-size: 14px; font-weight: 500; min-width: 80px;">
                            View
                        </button>
                    </td>
                `;
                
                // Details Row (initially hidden)
                const detailsRow = document.createElement('tr');
                detailsRow.classList.add('details-row');
                detailsRow.style.display = 'none';
                detailsRow.style.backgroundColor = '#f8f9fa';

                let detailsHtml = '<td colspan="4" style="padding: 16px 32px;">';
                const sortedDates = Object.keys(report.dailyUsage).sort(); // Sort dates chronologically

                sortedDates.forEach(date => {
                    // new Date(date) can be off by a day due to timezone, add timezone offset to correct it
                    const correctedDate = new Date(new Date(date).getTime() + new Date(date).getTimezoneOffset() * 60000);
                    const formattedDate = correctedDate.toLocaleDateString('en-US', { weekday: 'long', year: 'numeric', month: 'long', day: 'numeric' });
                    const dailyTotalDuration = formatDuration(report.dailyUsage[date]);

                    detailsHtml += `<div style="margin-bottom: 12px; padding-left: 16px;">`;
                    detailsHtml += `<strong style="font-weight: 600; color: #343a40;">${formattedDate}</strong>`;
                    detailsHtml += `<div style="font-size: 13px; margin-top: 4px; color: #495057;">${dailyTotalDuration}</div>`;
                    detailsHtml += `</div>`;
                });

                detailsHtml += '</td>';
                detailsRow.innerHTML = detailsHtml;

                reportBody.appendChild(mainRow);
                reportBody.appendChild(detailsRow);
            });

            // Add event listeners to new buttons
            document.querySelectorAll('.view-btn').forEach(button => {
                button.addEventListener('click', function() {
                    const detailsRow = this.closest('tr').nextElementSibling;
                    
                    if (detailsRow.style.display === 'none') {
                        detailsRow.style.display = 'table-row';
                        this.textContent = 'Hide';
                    } else {
                        detailsRow.style.display = 'none';
                        this.textContent = 'View';
                    }
                });
            });
        }

        // Set default dates and trigger a default search for a better initial view
        function initializeReport() {
            const today = new Date();
            const lastWeek = new Date();
            lastWeek.setDate(today.getDate() - 6);
            document.getElementById('end-date').value = today.toISOString().split('T')[0];
            document.getElementById('start-date').value = lastWeek.toISOString().split('T')[0];
            document.getElementById('app-search').value = 'https://app.clickup.com'; // Default search term
            document.getElementById('search-btn').click(); // Trigger search
        }

        // Initialize the report on page load
        initializeReport();

    </script>

</body>
</html>```
